{"version":3,"file":"Index-B3TTbqow.js","sources":["../../../app/javascript/dashboard/routes/dashboard/kanban/KanbanCard.vue","../../../app/javascript/dashboard/routes/dashboard/kanban/ConversationDetailModal.vue","../../../app/javascript/dashboard/routes/dashboard/kanban/Index.vue"],"sourcesContent":["<template>\r\n  <div\r\n    draggable=\"true\"\r\n    class=\"bg-white dark:bg-n-solid-3 p-4 rounded-lg border border-n-weak cursor-pointer hover:shadow-lg transition-all duration-200 hover:scale-[1.02]\"\r\n    @dragstart=\"$emit('dragstart', $event)\"\r\n    @click=\"onCardClick\"\r\n  >\r\n    <!-- Header do Card -->\r\n    <div class=\"flex items-start justify-between mb-3\">\r\n      <div class=\"flex items-center gap-2\">\r\n        <span class=\"px-2 py-0.5 text-xs font-medium text-green-700 bg-green-100 dark:bg-green-900/30 dark:text-green-400 rounded\">\r\n          #{{ conversation.id }}\r\n        </span>\r\n        <span\r\n          v-if=\"conversation.priority\"\r\n          class=\"w-2 h-2 rounded-full\"\r\n          :class=\"{\r\n            'bg-red-500': conversation.priority === 'urgent',\r\n            'bg-yellow-500': conversation.priority === 'high',\r\n            'bg-blue-500': conversation.priority === 'medium',\r\n          }\"\r\n        ></span>\r\n      </div>\r\n      \r\n      <!-- Menu Dropdown -->\r\n      <div class=\"relative\">\r\n        <button \r\n          @click.stop=\"toggleMenu\"\r\n          class=\"text-n-slate-10 hover:text-n-slate-12 transition-colors p-1 hover:bg-n-solid-4 rounded\"\r\n        >\r\n          <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z\" />\r\n          </svg>\r\n        </button>\r\n\r\n        <!-- Dropdown Menu -->\r\n        <div\r\n          v-if=\"showMenu\"\r\n          v-on-click-outside=\"() => closeMenu()\"\r\n          class=\"absolute right-0 mt-1 w-48 bg-white dark:bg-n-solid-6 rounded-lg shadow-lg border border-n-weak z-50\"\r\n        >\r\n          <div class=\"py-1\">\r\n            <button\r\n              @click=\"viewDetails\"\r\n              class=\"w-full px-4 py-2 text-left text-sm text-n-slate-12 dark:text-n-slate-11 hover:bg-gray-50 dark:hover:bg-n-solid-5 transition-colors flex items-center gap-2\"\r\n            >\r\n              <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\r\n              </svg>\r\n              Ver Detalhes\r\n            </button>\r\n            <button\r\n              @click=\"openConversation($event)\"\r\n              class=\"w-full px-4 py-2 text-left text-sm text-n-slate-12 dark:text-n-slate-11 hover:bg-gray-50 dark:hover:bg-n-solid-5 transition-colors flex items-center gap-2\"\r\n            >\r\n              <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n              </svg>\r\n              Abrir Conversa\r\n            </button>\r\n            <hr class=\"my-1 border-n-weak\" />\r\n            <button\r\n              @click=\"resolveConversation\"\r\n              class=\"w-full px-4 py-2 text-left text-sm text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 transition-colors flex items-center gap-2\"\r\n            >\r\n              <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\" />\r\n              </svg>\r\n              Resolver\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- TÃ­tulo/Nome do Contato -->\r\n    <h3 class=\"font-semibold text-n-slate-12 mb-2 line-clamp-2\">\r\n      {{ conversation.meta.sender.name }}\r\n    </h3>\r\n\r\n    <!-- Ãšltima Mensagem -->\r\n    <p class=\"text-sm text-n-slate-11 mb-4 line-clamp-2\">\r\n      {{ lastMessage }}\r\n    </p>\r\n\r\n    <!-- Labels com cores da API -->\r\n    <div v-if=\"conversationLabels.length > 0\" class=\"flex flex-wrap gap-1 mb-3\">\r\n      <span\r\n        v-for=\"label in conversationLabels.slice(0, 3)\"\r\n        :key=\"label.id || label.title\"\r\n        class=\"px-2 py-0.5 text-xs font-medium rounded\"\r\n        :style=\"getLabelStyle(label)\"\r\n      >\r\n        {{ label.title }}\r\n      </span>\r\n      <span\r\n        v-if=\"conversationLabels.length > 3\"\r\n        class=\"px-2 py-0.5 text-xs font-medium text-n-slate-11 bg-n-solid-4 rounded\"\r\n      >\r\n        +{{ conversationLabels.length - 3 }}\r\n      </span>\r\n    </div>\r\n\r\n    <!-- Footer do Card -->\r\n    <div class=\"flex items-center justify-between pt-3 border-t border-n-weak\">\r\n      <div class=\"flex items-center gap-2\">\r\n        <!-- Avatar do usuÃ¡rio com foto ou iniciais -->\r\n        <div class=\"w-6 h-6 min-w-[24px] min-h-[24px] rounded-full flex-shrink-0 overflow-hidden\">\r\n          <img\r\n            v-if=\"userAvatar\"\r\n            :src=\"userAvatar\"\r\n            :alt=\"conversation.meta.sender.name\"\r\n            class=\"w-full h-full object-cover\"\r\n            @error=\"onAvatarError\"\r\n          />\r\n          <div\r\n            v-else\r\n            class=\"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-semibold\"\r\n          >\r\n            {{ getInitials(conversation.meta.sender.name) }}\r\n          </div>\r\n        </div>\r\n        <span class=\"text-xs text-n-slate-11 truncate max-w-[120px]\">\r\n          {{ conversation.meta.sender.phone_number || 'Sem telefone' }}\r\n        </span>\r\n      </div>\r\n      \r\n      <div class=\"flex items-center gap-2 text-n-slate-11\">\r\n        <div v-if=\"conversation.unread_count > 0\" class=\"flex items-center gap-1\">\r\n          <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z\" />\r\n          </svg>\r\n          <span class=\"text-xs font-medium bg-red-500 text-white px-1.5 py-0.5 rounded-full\">\r\n            {{ conversation.unread_count }}\r\n          </span>\r\n        </div>\r\n        <span class=\"text-xs\">{{ getTimeAgo(conversation.last_activity_at) }}</span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from 'vue';\r\nimport { useRouter, useRoute } from 'vue-router';\r\nimport { useMapGetter } from 'dashboard/composables/store';\r\nimport { vOnClickOutside } from '@vueuse/components';\r\n\r\nconst props = defineProps({\r\n  conversation: {\r\n    type: Object,\r\n    required: true,\r\n  },\r\n});\r\n\r\nconst emit = defineEmits(['dragstart', 'view-details']);\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\nconst showMenu = ref(false);\r\nconst avatarError = ref(false);\r\n\r\n// Busca as labels diretamente do Vuex store\r\nconst allLabels = useMapGetter('labels/getLabels');\r\n\r\nconst lastMessage = computed(() => {\r\n  if (props.conversation.last_non_activity_message) {\r\n    return props.conversation.last_non_activity_message.content || 'Sem mensagens';\r\n  }\r\n  return 'Sem mensagens';\r\n});\r\n\r\n// Avatar do usuÃ¡rio\r\nconst userAvatar = computed(() => {\r\n  if (avatarError.value) return null;\r\n  \r\n  // Tenta pegar a foto do thumbnail primeiro, depois a foto normal\r\n  const avatar = props.conversation.meta?.sender?.thumbnail || \r\n                 props.conversation.meta?.sender?.avatar ||\r\n                 props.conversation.meta?.sender?.avatar_url;\r\n  \r\n  return avatar || null;\r\n});\r\n\r\n// Computed para obter labels com cores da API do Vuex\r\nconst conversationLabels = computed(() => {\r\n  if (!props.conversation.labels || props.conversation.labels.length === 0) {\r\n    return [];\r\n  }\r\n\r\n  // Se nÃ£o tiver labels disponÃ­veis no store, retorna as labels sem cores\r\n  if (!allLabels.value || allLabels.value.length === 0) {\r\n    console.warn('âš ï¸ Labels do store nÃ£o disponÃ­veis');\r\n    return props.conversation.labels.map(label => {\r\n      if (typeof label === 'string') {\r\n        return { title: label, color: '#3b82f6' };\r\n      }\r\n      return label;\r\n    });\r\n  }\r\n\r\n  // Mapeia as labels da conversa com as informaÃ§Ãµes completas da API\r\n  return props.conversation.labels.map(conversationLabel => {\r\n    const labelTitle = typeof conversationLabel === 'string' \r\n      ? conversationLabel \r\n      : conversationLabel.title;\r\n\r\n    // Busca a label completa no store\r\n    const fullLabel = allLabels.value.find(\r\n      apiLabel => apiLabel.title === labelTitle\r\n    );\r\n\r\n    if (fullLabel) {\r\n      console.log(`âœ… Label encontrada: ${labelTitle} -> ${fullLabel.color}`);\r\n      return {\r\n        id: fullLabel.id,\r\n        title: fullLabel.title,\r\n        color: fullLabel.color,\r\n        description: fullLabel.description\r\n      };\r\n    }\r\n\r\n    // Fallback se nÃ£o encontrar a label na API\r\n    console.warn(`âš ï¸ Label nÃ£o encontrada no store: ${labelTitle}`);\r\n    return {\r\n      title: labelTitle,\r\n      color: '#3b82f6'\r\n    };\r\n  });\r\n});\r\n\r\nconst onAvatarError = () => {\r\n  avatarError.value = true;\r\n};\r\n\r\nconst getInitials = (name) => {\r\n  if (!name || typeof name !== 'string' || name.trim() === '') return '?';\r\n  \r\n  const parts = name.trim().split(/\\s+/).filter(part => part.length > 0);\r\n  \r\n  if (parts.length >= 2) {\r\n    return (parts[0][0] + parts[1][0]).toUpperCase();\r\n  }\r\n  \r\n  if (parts.length === 1 && parts[0].length > 0) {\r\n    return parts[0][0].toUpperCase();\r\n  }\r\n  \r\n  return '?';\r\n};\r\n\r\n// FunÃ§Ã£o para obter o estilo da label com cores da API\r\nconst getLabelStyle = (label) => {\r\n  const color = label.color || '#3b82f6';\r\n  \r\n  return {\r\n    backgroundColor: `${color}20`, // 20 Ã© a opacidade em hex (~12%)\r\n    color: color,\r\n    borderColor: color,\r\n    borderWidth: '1px',\r\n    borderStyle: 'solid'\r\n  };\r\n};\r\n\r\nconst getTimeAgo = (timestamp) => {\r\n  if (!timestamp) return '';\r\n  \r\n  const now = Math.floor(Date.now() / 1000);\r\n  const diff = now - timestamp;\r\n  \r\n  if (diff < 60) return 'agora';\r\n  if (diff < 3600) return `${Math.floor(diff / 60)}m`;\r\n  if (diff < 86400) return `${Math.floor(diff / 3600)}h`;\r\n  return `${Math.floor(diff / 86400)}d`;\r\n};\r\n\r\n// ðŸ”¥ FUNÃ‡ÃƒO AUXILIAR: Navega para a conversa\r\nconst navigateToConversation = (event) => {\r\n  const currentPath = route.path;\r\n  \r\n  // Remove /kanban da URL\r\n  const basePath = currentPath.replace(/\\/kanban.*$/, '');\r\n  \r\n  // ConstrÃ³i a nova URL\r\n  const newPath = `${basePath}/conversations/${props.conversation.id}`;\r\n  \r\n  console.log('ðŸš€ Navegando de:', currentPath);\r\n  console.log('ðŸš€ Para:', newPath);\r\n  \r\n  // Se Ctrl/Cmd pressionado, abre em nova aba\r\n  if (event && (event.metaKey || event.ctrlKey)) {\r\n    event.preventDefault();\r\n    window.open(\r\n      `${window.location.origin}${newPath}`,\r\n      '_blank',\r\n      'noopener,noreferrer'\r\n    );\r\n    return;\r\n  }\r\n  \r\n  // SenÃ£o, navega normalmente\r\n  router.push(newPath);\r\n};\r\n\r\n// ðŸ”¥ CORRIGIDO: Click no card\r\nconst onCardClick = (e) => {\r\n  // Ignora se clicou em botÃ£o ou menu estÃ¡ aberto\r\n  if (e.target.closest('button') || showMenu.value) {\r\n    return;\r\n  }\r\n  \r\n  navigateToConversation(e);\r\n};\r\n\r\nconst toggleMenu = () => {\r\n  showMenu.value = !showMenu.value;\r\n};\r\n\r\nconst closeMenu = () => {\r\n  showMenu.value = false;\r\n};\r\n\r\nconst viewDetails = () => {\r\n  closeMenu();\r\n  emit('view-details', props.conversation);\r\n};\r\n\r\n// ðŸ”¥ CORRIGIDO: Abrir conversa do menu\r\nconst openConversation = (event) => {\r\n  closeMenu();\r\n  navigateToConversation(event);\r\n};\r\n\r\nconst resolveConversation = () => {\r\n  closeMenu();\r\n  console.log('Resolver conversa:', props.conversation.id);\r\n};\r\n</script>","<template>\r\n  <Teleport to=\"body\">\r\n    <Transition name=\"modal\">\r\n      <div\r\n        v-if=\"isOpen\"\r\n        class=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50\"\r\n        @click.self=\"closeModal\"\r\n      >\r\n        <div class=\"bg-white dark:bg-n-solid-3 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden\">\r\n          <!-- Header -->\r\n          <div class=\"flex items-center justify-between p-6 border-b border-n-weak\">\r\n            <div class=\"flex items-center gap-3\">\r\n              <img\r\n                v-if=\"conversation?.meta?.sender?.thumbnail\"\r\n                :src=\"conversation.meta.sender.thumbnail\"\r\n                :alt=\"conversation.meta.sender.name\"\r\n                class=\"w-10 h-10 rounded-full object-cover\"\r\n              />\r\n              <div\r\n                v-else\r\n                class=\"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-medium\"\r\n              >\r\n                {{ getInitials(conversation?.meta?.sender?.name) }}\r\n              </div>\r\n              <div>\r\n                <h2 class=\"text-xl font-semibold text-n-slate-12\">\r\n                  {{ conversation?.meta?.sender?.name }}\r\n                </h2>\r\n                <p class=\"text-sm text-n-slate-11\">#{{ conversation?.id }}</p>\r\n              </div>\r\n            </div>\r\n            <button\r\n              @click=\"closeModal\"\r\n              class=\"text-n-slate-10 hover:text-n-slate-12 transition-colors p-2 hover:bg-n-solid-4 rounded-lg\"\r\n            >\r\n              <svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <!-- Body -->\r\n          <div class=\"p-6 overflow-y-auto max-h-[calc(90vh-180px)]\">\r\n            <!-- InformaÃ§Ãµes do Contato -->\r\n            <div class=\"mb-6\">\r\n              <label class=\"block text-sm font-medium text-n-slate-11 mb-2\">InformaÃ§Ãµes de Contato</label>\r\n              <div class=\"p-4 bg-n-solid-2 rounded-lg space-y-2\">\r\n                <div class=\"flex items-center gap-2\">\r\n                  <svg class=\"w-4 h-4 text-n-slate-11\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\r\n                  </svg>\r\n                  <span class=\"text-n-slate-12\">{{ conversation?.meta?.sender?.phone_number || 'NÃ£o informado' }}</span>\r\n                </div>\r\n                <div v-if=\"conversation?.meta?.sender?.email\" class=\"flex items-center gap-2\">\r\n                  <svg class=\"w-4 h-4 text-n-slate-11\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                  </svg>\r\n                  <span class=\"text-n-slate-12\">{{ conversation.meta.sender.email }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Status e Labels -->\r\n            <div class=\"grid grid-cols-2 gap-4 mb-6\">\r\n              <div>\r\n                <label class=\"block text-sm font-medium text-n-slate-11 mb-2\">Status</label>\r\n                <span\r\n                  class=\"inline-flex px-3 py-1 rounded-full text-xs font-medium\"\r\n                  :class=\"{\r\n                    'bg-green-100 text-green-700 dark:bg-green-900/30': conversation?.status === 'open',\r\n                    'bg-gray-100 text-gray-700 dark:bg-gray-900/30': conversation?.status === 'resolved',\r\n                  }\"\r\n                >\r\n                  {{ conversation?.status === 'open' ? 'Aberta' : 'Resolvida' }}\r\n                </span>\r\n              </div>\r\n              \r\n              <div>\r\n                <label class=\"block text-sm font-medium text-n-slate-11 mb-2\">NÃ£o lidas</label>\r\n                <span class=\"text-2xl font-semibold text-n-slate-12\">\r\n                  {{ conversation?.unread_count || 0 }}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Labels -->\r\n            <div v-if=\"conversation?.labels && conversation.labels.length > 0\" class=\"mb-6\">\r\n              <label class=\"block text-sm font-medium text-n-slate-11 mb-2\">Etiquetas</label>\r\n              <div class=\"flex flex-wrap gap-2\">\r\n                <span\r\n                  v-for=\"label in conversation.labels\"\r\n                  :key=\"label\"\r\n                  class=\"px-3 py-1 text-sm bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400 rounded-full\"\r\n                >\r\n                  {{ label }}\r\n                </span>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Ãšltima Mensagem -->\r\n            <div class=\"mb-6\">\r\n              <label class=\"block text-sm font-medium text-n-slate-11 mb-2\">Ãšltima Mensagem</label>\r\n              <div class=\"p-4 bg-n-solid-2 rounded-lg\">\r\n                <p class=\"text-n-slate-12\">{{ lastMessage }}</p>\r\n                <p class=\"text-xs text-n-slate-11 mt-2\">{{ formatDate(conversation?.last_activity_at) }}</p>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- InformaÃ§Ãµes Adicionais -->\r\n            <div class=\"grid grid-cols-2 gap-4\">\r\n              <div class=\"p-4 bg-n-solid-2 rounded-lg\">\r\n                <div class=\"flex items-center gap-2 text-n-slate-11 mb-1\">\r\n                  <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                  </svg>\r\n                  <span class=\"text-sm\">Criada em</span>\r\n                </div>\r\n                <p class=\"text-sm font-medium text-n-slate-12\">\r\n                  {{ formatDate(conversation?.created_at) }}\r\n                </p>\r\n              </div>\r\n              \r\n              <div class=\"p-4 bg-n-solid-2 rounded-lg\">\r\n                <div class=\"flex items-center gap-2 text-n-slate-11 mb-1\">\r\n                  <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                  </svg>\r\n                  <span class=\"text-sm\">Canal</span>\r\n                </div>\r\n                <p class=\"text-sm font-medium text-n-slate-12\">\r\n                  {{ conversation?.meta?.channel || 'API' }}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Footer -->\r\n          <div class=\"flex items-center justify-end gap-3 p-6 border-t border-n-weak bg-n-solid-2\">\r\n            <button\r\n              @click=\"closeModal\"\r\n              class=\"px-4 py-2 text-sm font-medium text-n-slate-11 hover:text-n-slate-12 transition-colors\"\r\n            >\r\n              Fechar\r\n            </button>\r\n            <button\r\n              @click=\"openConversation\"\r\n              class=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors\"\r\n            >\r\n              Abrir Conversa\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Transition>\r\n  </Teleport>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from 'vue';\r\nimport { useRouter, useRoute } from 'vue-router';\r\n\r\nconst props = defineProps({\r\n  isOpen: {\r\n    type: Boolean,\r\n    default: false,\r\n  },\r\n  conversation: {\r\n    type: Object,\r\n    default: null,\r\n  },\r\n});\r\n\r\nconst emit = defineEmits(['close']);\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\nconst closeModal = () => {\r\n  emit('close');\r\n};\r\n\r\nconst lastMessage = computed(() => {\r\n  if (props.conversation?.last_non_activity_message) {\r\n    return props.conversation.last_non_activity_message.content || 'Sem mensagens';\r\n  }\r\n  return 'Sem mensagens';\r\n});\r\n\r\nconst getInitials = (name) => {\r\n  if (!name) return '?';\r\n  const parts = name.split(' ');\r\n  if (parts.length >= 2) {\r\n    return (parts[0][0] + parts[1][0]).toUpperCase();\r\n  }\r\n  return name.substring(0, 2).toUpperCase();\r\n};\r\n\r\nconst formatDate = (timestamp) => {\r\n  if (!timestamp) return 'NÃ£o disponÃ­vel';\r\n  \r\n  const date = new Date(timestamp * 1000);\r\n  return date.toLocaleString('pt-BR', {\r\n    day: '2-digit',\r\n    month: 'short',\r\n    year: 'numeric',\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n  });\r\n};\r\n\r\nconst openConversation = () => {\r\n  closeModal();\r\n  \r\n  // ðŸ”¥ SOLUÃ‡ÃƒO FINAL: Remove /kanban e vai direto para /conversations/ID\r\n  const currentPath = route.path;\r\n  \r\n  // Remove /kanban da URL (e tudo depois dele)\r\n  const basePath = currentPath.replace(/\\/kanban.*$/, '');\r\n  \r\n  // ConstrÃ³i a URL simples: basePath + /conversations/ + ID\r\n  const newPath = `${basePath}/conversations/${props.conversation.id}`;\r\n  \r\n  console.log('ðŸš€ Navegando de:', currentPath);\r\n  console.log('ðŸš€ Para:', newPath);\r\n  \r\n  // Navega para a conversa\r\n  router.push(newPath);\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-enter-active,\r\n.modal-leave-active {\r\n  transition: opacity 0.3s ease;\r\n}\r\n\r\n.modal-enter-from,\r\n.modal-leave-to {\r\n  opacity: 0;\r\n}\r\n\r\n.modal-enter-active .bg-white,\r\n.modal-leave-active .bg-white {\r\n  transition: transform 0.3s ease;\r\n}\r\n\r\n.modal-enter-from .bg-white,\r\n.modal-leave-to .bg-white {\r\n  transform: scale(0.9);\r\n}\r\n</style>","<template>\r\n  <div class=\"flex flex-col h-full bg-n-solid-1 min-w-full\">\r\n    <!-- Header -->\r\n    <div class=\"p-4 border-b border-n-weak bg-n-solid-2\">\r\n      <div class=\"flex items-center justify-between\">\r\n        <h1 class=\"text-2xl font-semibold text-n-slate-12\">Kanban de Conversas</h1>\r\n        <button\r\n          @click=\"refreshData\"\r\n          :disabled=\"isLoading\"\r\n          class=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50\"\r\n        >\r\n          <span v-if=\"isLoading\">Carregando...</span>\r\n          <span v-else>ðŸ”„ Atualizar</span>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Loading State -->\r\n    <div v-if=\"isLoading && !hasConversations\" class=\"flex items-center justify-center flex-1\">\r\n      <div class=\"text-center\">\r\n        <div class=\"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\r\n        <p class=\"text-n-slate-11\">Carregando conversas...</p>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Kanban Board -->\r\n    <div v-else class=\"flex-1 overflow-x-auto p-4\">\r\n      <div class=\"flex gap-4 h-full min-w-max\">\r\n        <!-- Coluna: SEM ETIQUETA -->\r\n        <div class=\"flex flex-col w-80 bg-n-solid-2 rounded-lg\">\r\n          <div class=\"p-4 border-b border-n-weak\">\r\n            <div class=\"flex items-center justify-between\">\r\n              <div class=\"flex items-center gap-2\">\r\n                <span class=\"w-3 h-3 rounded-full bg-gray-400\"></span>\r\n                <h2 class=\"font-semibold text-n-slate-12\">SEM ETIQUETA</h2>\r\n              </div>\r\n              <span class=\"px-2 py-1 text-xs font-medium text-n-slate-11 bg-n-solid-3 rounded\">\r\n                {{ columns.semEtiqueta.length }}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"flex-1 p-3 overflow-y-auto space-y-3\"\r\n            @drop=\"onDrop($event, null)\"\r\n            @dragover.prevent\r\n            @dragenter.prevent\r\n          >\r\n            <KanbanCard\r\n              v-for=\"conversation in columns.semEtiqueta\"\r\n              :key=\"conversation.id\"\r\n              :conversation=\"conversation\"\r\n              @dragstart=\"onDragStart($event, conversation)\"\r\n              @view-details=\"openDetailsModal\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Colunas DinÃ¢micas baseadas nas Labels -->\r\n        <div\r\n          v-for=\"label in labelColumns\"\r\n          :key=\"label.title\"\r\n          class=\"flex flex-col w-80 bg-n-solid-2 rounded-lg\"\r\n        >\r\n          <div class=\"p-4 border-b border-n-weak\">\r\n            <div class=\"flex items-center justify-between\">\r\n              <div class=\"flex items-center gap-2\">\r\n                <span\r\n                  class=\"w-3 h-3 rounded-full ring-1 ring-black/10 dark:ring-white/20\"\r\n                  :style=\"{ backgroundColor: label.color }\"\r\n                ></span>\r\n                <h2 class=\"font-semibold text-n-slate-12\">{{ label.title.toUpperCase() }}</h2>\r\n              </div>\r\n              <span class=\"px-2 py-1 text-xs font-medium text-n-slate-11 bg-n-solid-3 rounded\">\r\n                {{ getColumnCount(label.title) }}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <div\r\n            class=\"flex-1 p-3 overflow-y-auto space-y-3\"\r\n            @drop=\"onDrop($event, label.title)\"\r\n            @dragover.prevent\r\n            @dragenter.prevent\r\n          >\r\n            <KanbanCard\r\n              v-for=\"conversation in getColumnConversations(label.title)\"\r\n              :key=\"conversation.id\"\r\n              :conversation=\"conversation\"\r\n              @dragstart=\"onDragStart($event, conversation)\"\r\n              @view-details=\"openDetailsModal\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Modal de Detalhes -->\r\n    <ConversationDetailModal\r\n      :is-open=\"isModalOpen\"\r\n      :conversation=\"selectedConversation\"\r\n      @close=\"closeDetailsModal\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, reactive, onMounted, computed } from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useMapGetter } from 'dashboard/composables/store';\r\nimport KanbanCard from './KanbanCard.vue';\r\nimport ConversationDetailModal from './ConversationDetailModal.vue';\r\nimport ConversationApi from '../../../api/conversations';\r\n\r\nconst store = useStore();\r\n\r\nconst draggedConversation = ref(null);\r\nconst isModalOpen = ref(false);\r\nconst selectedConversation = ref(null);\r\nconst isLoading = ref(false);\r\n\r\n// Busca as labels do store\r\nconst allLabels = useMapGetter('labels/getLabels');\r\n\r\nconst columns = reactive({\r\n  semEtiqueta: [],\r\n});\r\n\r\n// Cria um computed para as colunas de labels\r\nconst labelColumns = computed(() => {\r\n  return allLabels.value || [];\r\n});\r\n\r\nconst hasConversations = computed(() => {\r\n  const semEtiquetaCount = columns.semEtiqueta.length;\r\n  const labelColumnsCount = labelColumns.value.reduce((acc, label) => {\r\n    return acc + getColumnCount(label.title);\r\n  }, 0);\r\n  return semEtiquetaCount + labelColumnsCount > 0;\r\n});\r\n\r\n// Helper para pegar conversas de uma coluna especÃ­fica\r\nconst getColumnConversations = (labelTitle) => {\r\n  return columns[labelTitle] || [];\r\n};\r\n\r\n// Helper para pegar contagem de uma coluna especÃ­fica\r\nconst getColumnCount = (labelTitle) => {\r\n  return columns[labelTitle]?.length || 0;\r\n};\r\n\r\n// FunÃ§Ã£o para buscar conversas da API\r\n// FunÃ§Ã£o para buscar conversas da API\r\nconst fetchConversations = async () => {\r\n  isLoading.value = true;\r\n  try {\r\n    console.log('ðŸ” Buscando conversas...');\r\n    \r\n    const response = await ConversationApi.get({\r\n      status: 'open',\r\n      assigneeType: 'all',\r\n      page: 1,\r\n      sortBy: 'last_activity_at',\r\n    });\r\n    \r\n    console.log('ðŸ“¦ Resposta da API:', response);\r\n    console.log('ðŸ“¦ response.data:', response.data);\r\n    console.log('ðŸ“¦ response.data.data:', response.data.data);\r\n    \r\n    // CORREÃ‡ÃƒO: A estrutura Ã© response.data.data.payload\r\n    if (response.data && response.data.data && response.data.data.payload) {\r\n      console.log('âœ… Total de conversas:', response.data.data.payload.length);\r\n      distributeConversations(response.data.data.payload);\r\n    } else {\r\n      console.warn('âš ï¸ Nenhuma conversa encontrada na resposta');\r\n      console.log('Estrutura recebida:', response.data);\r\n    }\r\n  } catch (error) {\r\n    console.error('âŒ Erro ao buscar conversas:', error);\r\n  } finally {\r\n    isLoading.value = false;\r\n  }\r\n};\r\n\r\n// Distribui as conversas nas colunas baseado nas labels\r\nconst distributeConversations = (conversations) => {\r\n  // Limpa todas as colunas\r\n  columns.semEtiqueta = [];\r\n  \r\n  // Cria colunas para cada label\r\n  labelColumns.value.forEach(label => {\r\n    columns[label.title] = [];\r\n  });\r\n\r\n  // Distribui as conversas\r\n  conversations.forEach(conversation => {\r\n    if (!conversation.labels || conversation.labels.length === 0) {\r\n      // Sem etiqueta\r\n      columns.semEtiqueta.push(conversation);\r\n    } else {\r\n      // Pega a primeira label da conversa\r\n      const firstLabel = conversation.labels[0];\r\n      \r\n      // Se a coluna existe, adiciona lÃ¡\r\n      if (columns[firstLabel] !== undefined) {\r\n        columns[firstLabel].push(conversation);\r\n      } else {\r\n        // Se nÃ£o existe, adiciona em sem etiqueta\r\n        columns.semEtiqueta.push(conversation);\r\n      }\r\n    }\r\n  });\r\n};\r\n\r\nconst onDragStart = (event, conversation) => {\r\n  draggedConversation.value = conversation;\r\n  event.dataTransfer.effectAllowed = 'move';\r\n};\r\n\r\nconst onDrop = async (event, targetLabel) => {\r\n  event.preventDefault();\r\n  \r\n  if (!draggedConversation.value) return;\r\n\r\n  const conversationId = draggedConversation.value.id;\r\n  \r\n  // Remove da coluna original\r\n  for (const column in columns) {\r\n    const index = columns[column].findIndex(c => c.id === conversationId);\r\n    if (index !== -1) {\r\n      columns[column].splice(index, 1);\r\n      break;\r\n    }\r\n  }\r\n\r\n  // Atualiza as labels localmente\r\n  if (targetLabel === null) {\r\n    // Moveu para \"Sem Etiqueta\" - remove todas as labels\r\n    draggedConversation.value.labels = [];\r\n    columns.semEtiqueta.push(draggedConversation.value);\r\n  } else {\r\n    // Moveu para uma label especÃ­fica\r\n    draggedConversation.value.labels = [targetLabel];\r\n    if (!columns[targetLabel]) {\r\n      columns[targetLabel] = [];\r\n    }\r\n    columns[targetLabel].push(draggedConversation.value);\r\n  }\r\n  \r\n  // Atualiza as labels na API\r\n  try {\r\n    await updateConversationLabels(conversationId, targetLabel);\r\n  } catch (error) {\r\n    console.error('Erro ao atualizar labels:', error);\r\n    // Se der erro, recarrega as conversas\r\n    fetchConversations();\r\n  }\r\n  \r\n  draggedConversation.value = null;\r\n};\r\n\r\nconst updateConversationLabels = async (conversationId, newLabel) => {\r\n  try {\r\n    const labels = newLabel === null ? [] : [newLabel];\r\n    \r\n    await ConversationApi.updateLabels(conversationId, labels);\r\n    \r\n    console.log(`Labels da conversa ${conversationId} atualizadas para:`, labels);\r\n  } catch (error) {\r\n    console.error('Erro ao atualizar labels:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst refreshData = () => {\r\n  fetchConversations();\r\n};\r\n\r\nconst openDetailsModal = (conversation) => {\r\n  selectedConversation.value = conversation;\r\n  isModalOpen.value = true;\r\n};\r\n\r\nconst closeDetailsModal = () => {\r\n  isModalOpen.value = false;\r\n  selectedConversation.value = null;\r\n};\r\n\r\nonMounted(async () => {\r\n  // Carrega as labels primeiro\r\n  await store.dispatch('labels/get');\r\n  // Depois carrega as conversas\r\n  await fetchConversations();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.no-scrollbar::-webkit-scrollbar {\r\n  display: none;\r\n}\r\n\r\n.no-scrollbar {\r\n  -ms-overflow-style: none;\r\n  scrollbar-width: none;\r\n}\r\n</style>"],"names":["props","__props","emit","__emit","router","useRouter","route","useRoute","showMenu","ref","avatarError","allLabels","useMapGetter","lastMessage","computed","userAvatar","_b","_a","_d","_c","_f","_e","conversationLabels","label","conversationLabel","labelTitle","fullLabel","apiLabel","onAvatarError","getInitials","name","parts","part","getLabelStyle","color","getTimeAgo","timestamp","diff","navigateToConversation","event","currentPath","newPath","onCardClick","e","toggleMenu","closeMenu","viewDetails","openConversation","resolveConversation","closeModal","formatDate","store","useStore","draggedConversation","isModalOpen","selectedConversation","isLoading","columns","reactive","labelColumns","hasConversations","semEtiquetaCount","labelColumnsCount","acc","getColumnCount","getColumnConversations","fetchConversations","response","ConversationApi","distributeConversations","error","conversations","conversation","firstLabel","onDragStart","onDrop","targetLabel","conversationId","column","index","c","updateConversationLabels","newLabel","labels","refreshData","openDetailsModal","closeDetailsModal","onMounted"],"mappings":"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"}